// ********** Ø«ÙˆØ§Ø¨Øª ÙˆØ±ÙˆØ§Ø¨Ø· (ÙƒÙ…Ø§ ÙÙŠ ÙƒÙˆØ¯Ùƒ Ø§Ù„Ø£ØµÙ„ÙŠ) **********
const PROXY_URL = 'https://cors-anywhere.herokuapp.com/';
// Ø¨Ø¯ÙŠÙ„ Ø¥Ø°Ø§ Ù„Ø²Ù…: 'https://api.allorigins.win/raw?url='
const SECRET_STRING = ",{.c][o^uecnlkijh*.iomv:QzCFRcd;drof/zx}w;ls.e85T^#ASwa?=(lk";
const CHANNEL_DATA = '{"channel":{"ChannelName":"MobinilAndMe","Password":"ig3yh*mk5l42@oj7QAR8yF"}}';
const APP_VERSION = "9.0.1";

const URLS = {
  TOKEN: PROXY_URL + "https://services.orange.eg/GetToken.svc/GenerateToken",
  FORGOT_PASS: PROXY_URL + "https://services.orange.eg/ProfileService.svc/ForgotPassword",
  SIGNIN: PROXY_URL + "https://services.orange.eg/SignIn.svc/SignInUser",
  GENERATE_BASIC_TOKEN: PROXY_URL + "https://services.orange.eg/APIs/Profile/api/BasicAuthentication/Generate",
  REDEEM_RAMADAN: PROXY_URL + "https://services.orange.eg/APIs/Promotions/api/CAF/Redeem",
  REDEEM_DANONE: PROXY_URL + "https://services.orange.eg/APIs/Promotions/api/Danone/RedeemVoucher",
  MERIDA: PROXY_URL + "https://api.meridagame.com/api/speedRedeemOffer",
  FAWAZEER_QUESTIONS: PROXY_URL + "https://services.orange.eg/APIs/Ramadan2024/api/RamadanOffers/Fawazeer/Questions",
  FAWAZEER_SUBMIT: PROXY_URL + "https://services.orange.eg/APIs/Ramadan2024/api/RamadanOffers/Fawazeer/Submit"
};

let currentService = '';

// ---------- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ----------
function showMainMenu() {
  document.getElementById('mainMenu').style.display = 'flex';
  document.getElementById('inputSection').style.display = 'none';
  document.getElementById('resultSection').style.display = 'none';
  document.getElementById('loadingSection').style.display = 'none';
  document.getElementById('danoneNotice').style.display = 'none';
  currentService = '';
}

function showInput(service) {
  currentService = service;
  document.getElementById('mainMenu').style.display = 'none';
  document.getElementById('inputSection').style.display = 'block';
  document.getElementById('passwordGroup').style.display = 'none';
  document.getElementById('danoneNotice').style.display = 'none';

  const labels = {
    'merida': 'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù„ØªÙØ¹ÙŠÙ„ Ø¹Ø±Ø¶ 1000 Ù…ÙŠØ¬Ø§',
    'ramadan': 'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù„ØªÙØ¹ÙŠÙ„ Ø¹Ø±Ø¶ 500 Ù…ÙŠØ¬Ø§',
    'fawazeer': 'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù„ØªÙØ¹ÙŠÙ„ Ø¹Ø±Ø¶ 250 Ù…ÙŠØ¬Ø§ ÙÙˆØ§Ø²ÙŠØ±',
    'danone': 'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù„ØªÙØ¹ÙŠÙ„ Ø¹Ø±Ø¶ 250 Ù…ÙŠØ¬Ø§ Ø¯Ø§Ù†ÙˆÙ†',
    'password': 'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù„Ø§Ø³ØªØ±Ø¬Ø§Ø¹ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±'
  };
  document.getElementById('inputLabel').textContent = labels[service] || 'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ';
  document.getElementById('phoneInput').value = '';
  document.getElementById('passwordInput').value = '';

  if (service !== 'merida' && service !== 'password') {
    document.getElementById('passwordGroup').style.display = 'block';
  }
  if (service === 'danone') {
    document.getElementById('danoneNotice').style.display = 'block';
  }
}

function showLoading(text = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©... â³') {
  document.getElementById('inputSection').style.display = 'none';
  document.getElementById('loadingSection').style.display = 'block';
  document.getElementById('resultSection').style.display = 'none';
  document.getElementById('loadingText').textContent = text;
}

function showResult(message, type = 'success') {
  document.getElementById('loadingSection').style.display = 'none';
  document.getElementById('resultSection').style.display = 'block';
  const resultDiv = document.getElementById('resultMessage');
  resultDiv.innerHTML = `<div class="${type}">${message}</div>`;
}

// ---------- Ø¯Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¹Ø§Ù… Ù…Ø¹ logging ÙˆÙ…Ø­Ø§ÙˆÙ„Ø© ØªØ­Ù„ÙŠÙ„ JSON ----------
async function makeRequest(url, options = {}) {
  try {
    const defaultOptions = {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json; charset=UTF-8',
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)'
      },
      ...options
    };

    console.log('Making request to:', url);
    const response = await fetch(url, defaultOptions);

    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }

    const text = await response.text();
    console.log('Raw response:', text);

    try {
      return JSON.parse(text);
    } catch (e) {
      return text;
    }
  } catch (error) {
    console.error('Request failed:', error);
    throw error;
  }
}

// ---------- Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (ØªØ³ØªØ¹Ù…Ù„ Ø§Ù„Ù€ API Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©) ----------

// 1) Merida (ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„Ø£ØµÙ„)
async function processMerida(phone) {
  try {
    showLoading('Ø¬Ø§Ø±ÙŠ ØªÙØ¹ÙŠÙ„ Ø¹Ø±Ø¶ 1000 Ù…ÙŠØ¬Ø§...');
    const payload = new URLSearchParams({
      msisdn: phone,
      lang: "ar"
    });

    const response = await fetch(URLS.MERIDA, {
      method: 'POST',
      headers: {
        'User-Agent': 'Mozilla/5.0',
        'Origin': 'https://speed.meridagame.com',
        'Referer': 'https://speed.meridagame.com/',
        'Content-Type': 'application/x-www-form-urlencoded'
      },
      body: payload
    });

    const data = await response.json();
    const msg = data?.data?.redeemOutputs?.RedeemErrorDoc?.errDesc || "Success";

    if (msg.toLowerCase() === "success") {
      return { success: true, message: "âœ… Ù…Ø¨Ø±ÙˆÙˆÙˆÙˆÙƒ! ØªÙ… ØªÙØ¹ÙŠÙ„ Ø¹Ø±Ø¶ 1000 Ù…ÙŠØ¬Ø§ Ø¨Ù†Ø¬Ø§Ø­\n@alturky_2006" };
    } else if (msg.includes("capping capacity")) {
      return { success: false, message: "âš ï¸ Ø­ØµÙ„Øª Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¶ Ù…Ø³Ø¨Ù‚Ø§Ù‹ ğŸ˜¥", type: 'warning' };
    } else {
      return { success: false, message: `ğŸ”´ ${msg}` };
    }
  } catch (error) {
    console.error('Merida Error:', error);
    return { success: false, message: "ğŸ”´ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹." };
  }
}

// 2) Ramadan (500 MB)
async function processRamadan(phone, password) {
  try {
    showLoading('Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...');

    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ†
    const tokenData = await makeRequest(URLS.TOKEN, { body: CHANNEL_DATA });

    if (!tokenData || !tokenData.GenerateTokenResult) {
      return { success: false, message: "ğŸ”´ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ† Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…" };
    }

    const ctv = tokenData.GenerateTokenResult.Token;
    const htv = await generateSHA256(ctv + SECRET_STRING);

    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    showLoading('Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...');
    const signInResult = await signInOrange(phone, password);

    if (!signInResult.success) {
      return { success: false, message: "ğŸ”´ Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„. ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø±Ù‚Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±." };
    }

    // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶
    showLoading('Ø¬Ø§Ø±ÙŠ ØªÙØ¹ÙŠÙ„ Ø¹Ø±Ø¶ 500 Ù…ÙŠØ¬Ø§...');
    const redeemPayload = {
      "Language": "ar",
      "OSVersion": "Android7.0",
      "PromoCode": "Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ…",
      "dial": phone,
      "password": password,
      "Channelname": "MobinilAndMe",
      "ChannelPassword": "ig3yh*mk5l42@oj7QAR8yF"
    };

    const result = await makeRequest(URLS.REDEEM_RAMADAN, {
      headers: {
        '_ctv': ctv,
        '_htv': htv,
        'UserId': signInResult.userId,
        'Content-Type': 'application/json; charset=UTF-8',
        'User-Agent': 'okhttp/3.14.9'
      },
      body: JSON.stringify(redeemPayload)
    });

    // result Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ù†Øµ Ø£Ùˆ JSON
    const errorDesc = result?.ErrorDescription || (typeof result === 'string' ? result : '');
    const errorCode = result?.ErrorCode ?? (typeof result === 'string' ? -1 : -1);

    // Ø­Ø§Ù„Ø© Ù†Ø¬Ø§Ø­
    if (errorCode === 0) {
      return {
        success: true,
        message: `ğŸ‰ Ù…Ø¨Ø±ÙˆÙˆÙˆÙˆÙƒ ØªÙ… Ø¥Ø¶Ø§ÙØ© 500 Ù…ÙŠØ¬Ø§ Ø¨Ù†Ø¬Ø§Ø­ Ù„Ø±Ù‚Ù… (${phone})`
      };
    }

    // Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù† Ù‚Ø¨Ù„ (ÙƒÙ…Ø§ ØªÙ… ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ Ø³Ø§Ø¨Ù‚Ø§Ù‹)
    const errDescLower = (errorDesc || '').toString().toLowerCase();
    if (errDescLower.includes("ØªÙ… Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù† Ù‚Ø¨Ù„") || errDescLower.includes("used before") || errDescLower.includes("already used") || errorCode !== 0) {
      return {
        success: false,
        message: "Ù„Ù‚Ø¯ Ø­ØµÙ„Øª Ø¹Ù„ÙŠ Ø§Ù„Ø¹Ø±Ø¶ Ù…Ù† Ù‚Ø¨Ù„ Ø­Ø§ÙˆÙ„ ÙÙŠ ÙˆÙ‚Øª Ù„Ø§Ø­Ù‚ âš ï¸",
        type: 'warning'
      };
    }

    // Ø­Ø§Ù„Ø§Øª Ø§Ø®Ø±Ù‰ (Ø§Ø­ØªÙŠØ§Ø·ÙŠ)
    return {
      success: false,
      message: `ğŸ”´ ${errorDesc || 'ÙØ´Ù„ ÙÙŠ Ø§Ù„ØªÙØ¹ÙŠÙ„'}`
    };

  } catch (error) {
    console.error('Ramadan Error:', error);
    return { success: false, message: "ğŸ”´ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹." };
  }
}

// 3) Ø§Ø³ØªØ±Ø¬Ø§Ø¹ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± (ÙƒÙ…Ø§ ÙƒØ§Ù†)
async function processForgotPassword(phone) {
  try {
    showLoading('Ø¬Ø§Ø±ÙŠ Ø·Ù„Ø¨ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©...');

    const tokenData = await makeRequest(URLS.TOKEN, { body: CHANNEL_DATA });

    if (!tokenData?.GenerateTokenResult?.Token) {
      return { success: false, message: "ğŸ”´ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø®Ø§Ø¯Ù… Ø§ÙˆØ±Ø§Ù†Ø¬" };
    }

    const ctv = tokenData.GenerateTokenResult.Token;
    const htv = await generateSHA256(ctv + SECRET_STRING);

    const payload = {
      "channel": {
        "ChannelName": "MobinilAndMe",
        "Password": "ig3yh*mk5l42@oj7QAR8yF"
      },
      "dialNumber": phone,
      "lang": "ar"
    };

    const response = await makeRequest(URLS.FORGOT_PASS, {
      headers: {
        '_ctv': ctv,
        '_htv': htv,
        'Content-Type': 'application/json; charset=UTF-8',
        'User-Agent': 'okhttp/3.14.9'
      },
      body: JSON.stringify(payload)
    });

    const responseText = typeof response === 'string' ? response : JSON.stringify(response);

    if (responseText.includes("user data is null") || responseText.includes("UserDataIsNull")) {
      return { success: false, message: "ğŸ”´ Ø§Ù„Ø±Ù‚Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„ ÙÙŠ Ø®Ø¯Ù…Ø© Ø§ÙˆØ±Ø§Ù†Ø¬" };
    } else if (responseText.toLowerCase().includes("success")) {
      return { success: true, message: "âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ÙÙŠ Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø¥Ù„Ù‰ Ù‡Ø§ØªÙÙƒ" };
    } else if (responseText.toLowerCase().includes("invalid")) {
      return { success: false, message: "âš ï¸ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ØºÙŠØ± ØµØ­ÙŠØ­" };
    } else {
      return { success: false, message: "âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ±Ø¬Ø§Ø¹ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø­Ø§Ù„ÙŠØ§Ù‹. Ø­Ø§ÙˆÙ„ Ù„Ø§Ø­Ù‚Ø§Ù‹" };
    }

  } catch (error) {
    console.error('Forgot Password Error:', error);
    return { success: false, message: "ğŸ”´ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…. ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª" };
  }
}

// 4) ÙÙˆØ§Ø²ÙŠØ± (ØªØ­Øª Ø§Ù„ØµÙŠØ§Ù†Ø©)
async function processFawazeer(phone, password) {
  return {
    success: false,
    message: "âš ï¸ Ø§Ù„Ø®Ø¯Ù…Ø© ØªØ­Øª Ø§Ù„ØµÙŠØ§Ù†Ø© Ø­Ø§Ù„ÙŠØ§Ù‹ØŒ Ø³Ù†Ù‚ÙˆÙ… Ø¨Ø¥Ø®Ø¨Ø§Ø±ÙƒÙ… Ø¹Ù†Ø¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ù† Ø§Ù„ØµÙŠØ§Ù†Ø©"
  };
}

// 5) Ø¯Ø§Ù†ÙˆÙ† (ØªØ­Øª Ø§Ù„ØµÙŠØ§Ù†Ø©)
async function processDanone(phone, password) {
  return {
    success: false,
    message: "âš ï¸ Ø§Ù„Ø®Ø¯Ù…Ø© ØªØ­Øª Ø§Ù„ØµÙŠØ§Ù†Ø© Ø­Ø§Ù„ÙŠØ§Ù‹ØŒ Ø³Ù†Ù‚ÙˆÙ… Ø¨Ø¥Ø®Ø¨Ø§Ø±ÙƒÙ… Ø¹Ù†Ø¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ù† Ø§Ù„ØµÙŠØ§Ù†Ø©"
  };
}

// ---------- Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© ----------
async function signInOrange(number, password) {
  try {
    const payload = {
      "appVersion": APP_VERSION,
      "channel": {
        "ChannelName": "MobinilAndMe",
        "Password": "ig3yh*mk5l42@oj7QAR8yF"
      },
      "dialNumber": number,
      "isAndroid": true,
      "lang": "ar",
      "password": password
    };

    const data = await makeRequest(URLS.SIGNIN, { body: JSON.stringify(payload) });
    const result = data?.SignInUserResult;

    if (result?.AccessToken && result?.ErrorCode === 0) {
      return {
        success: true,
        userId: result.UserData?.UserID,
        accessToken: result.AccessToken
      };
    } else {
      const errorMsg = result?.ErrorDescription || 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©';
      throw new Error(errorMsg);
    }
  } catch (error) {
    console.error('SignIn Error:', error);
    return { success: false, error: error.message };
  }
}

async function generateSHA256(text) {
  try {
    const encoder = new TextEncoder();
    const data = encoder.encode(text);
    const hashBuffer = await crypto.subtle.digest('SHA-256', data);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    return hashHex.toUpperCase();
  } catch (error) {
    console.error('Hash Error:', error);
    return 'HASH_ERROR_' + Math.random().toString(36).substr(2, 9);
  }
}

// ---------- Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ ØªÙØ¹ÙŠÙ„ ----------
async function processRequest() {
  const phone = document.getElementById('phoneInput').value.trim();
  const password = document.getElementById('passwordInput').value.trim();

  if (!phone) {
    showResult('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ', 'error');
    return;
  }
  if (!phone.match(/^01[0-9]{9}$/)) {
    showResult('âš ï¸ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ØºÙŠØ± ØµØ§Ù„Ø­. ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 01 ÙˆÙŠØªÙƒÙˆÙ† Ù…Ù† 11 Ø±Ù‚Ù…Ø§Ù‹', 'error');
    return;
  }

  // Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±
  if ((currentService === 'ramadan' || currentService === 'fawazeer' || currentService === 'danone') && !password) {
    showResult('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±', 'error');
    return;
  }

  showLoading();

  try {
    let result;
    switch (currentService) {
      case 'merida':
        result = await processMerida(phone);
        break;
      case 'ramadan':
        result = await processRamadan(phone, password);
        break;
      case 'fawazeer':
        result = await processFawazeer(phone, password);
        break;
      case 'danone':
        result = await processDanone(phone, password);
        break;
      case 'password':
        result = await processForgotPassword(phone);
        break;
      default:
        result = { success: false, message: 'âš ï¸ Ø§Ù„Ø®Ø¯Ù…Ø© ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ©' };
    }

    // Ù†ÙˆØ¹ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©: success => Ù…Ø±Ø¨Ø¹ successØŒ Ø®Ù„Ø§Ù Ø°Ù„Ùƒ Ø®Ø·Ø£
    showResult(result.message, result.success ? 'success' : 'error');

  } catch (error) {
    console.error('Process Error:', error);
    showResult('ğŸ”´ Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹.', 'error');
  }
}

// ---------- Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ÙˆØ§Ù„ØªÙ‡ÙŠØ¦Ø© ----------
document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.menu-btn[data-service]').forEach(button => {
    button.addEventListener('click', function() {
      showInput(this.getAttribute('data-service'));
    });
  });

  document.getElementById('submitBtn').addEventListener('click', processRequest);
  document.getElementById('backBtn').addEventListener('click', showMainMenu);
  document.getElementById('resultBackBtn').addEventListener('click', showMainMenu);

  document.getElementById('phoneInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') processRequest();
  });
  document.getElementById('passwordInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') processRequest();
  });

  showMainMenu();
  console.log('Orange Bot Loaded Successfully');
});
